<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://blog.wedrop.it name=base><title>Drop a Blog • Fedora 21 VPN problems</title><link title="Drop a Blog - Atom Feed" href=https://blog.wedrop.it/atom.xml rel=alternate type=application/atom+xml><link href="https://blog.wedrop.it/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://blog.wedrop.it/main.css?h=fa464346b37e382872db" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="At the office, a few us use Fedora. The main reasons are that it's a fairly good
desktop distribution, and the software is nice and bleeding edge; perfect for developers. But
sometimes, it breaks." name=description><meta content="At the office, a few us use Fedora. The main reasons are that it's a fairly good
desktop distribution, and the software is nice and bleeding edge; perfect for developers. But
sometimes, it breaks." property=og:description><meta content="Fedora 21 VPN problems" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://blog.wedrop.it/blog/fedora-21-vpn-problems/ property=og:url><meta content="Drop a Blog" property=og:site_name><noscript><link href=https://blog.wedrop.it/no_js.css rel=stylesheet></noscript><script src=https://blog.wedrop.it/js/initializeTheme.min.js></script><script defer src=https://blog.wedrop.it/js/themeSwitcher.min.js></script><meta content=@teotwaki@mastodon.online name=fediverse:creator><script src="https://blog.wedrop.it/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://blog.wedrop.it>Drop a Blog</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://blog.wedrop.it/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://blog.wedrop.it/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://blog.wedrop.it/tags/>tags </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Fedora 21 VPN problems</h1><ul class=meta><li>3rd Feb 2015<li title="322 words"><span aria-hidden=true class=separator>•</span>2 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a href=https://blog.wedrop.it/tags/tech/>tech</a>, <li class=tag><a href=https://blog.wedrop.it/tags/linux/>linux</a>, <li class=tag><a href=https://blog.wedrop.it/tags/networking/>networking</a></ul><section class=body><p>At the office, a few us use Fedora. The main reasons are that it’s a fairly good desktop distribution, and the software is nice and bleeding edge; perfect for developers. But sometimes, it breaks.<p>I’m still on Fedora 20, but a handful of coworkers have either upgraded to Fedora 21 or installed the latest version because they recently got new computers (and crunchbang doesn’t play well with newer Haswell setups). All the new setups had one problem: they couldn’t connect to one of our VPNs. We’re in the process of migrating to <a href=https://www.softether.org/>SoftEther</a>, but this particular VPN still uses PPTP while we validate that SoftEther can handle our load.<p>So what happened? The short answer is that the VPN wouldn’t connect. It would take ages for the connection attempt to fail, and <a href=https://gist.github.com/slauwers/ac2cd840aef6f3bbea84>in the logs</a>, we’d see something along the lines of:<pre class=z-code><code><span class="z-text z-plain">LCP: timeout sending Config-Requests
</span></code></pre><p>After <a href=http://askubuntu.com/questions/572497/cant-connect-to-pptp-vpn-with-ufw-enabled-on-ubuntu-14-04-with-kernel-3-18>a bit of digging</a>, it turns out that there are a few packets that <a href="http://marc.info/?l=netfilter&m=142195881513706">are being blocked by the firewall since the 3.18 kernel</a>:<blockquote><p>As expected, with the 3.2.x kernel :<p>if neither nf_conntrack_proto_gre nor nf_conntrack_pptp are loaded, the first GRE packet of a plain GRE tunnel (as set by ip tunnel) or a PPTP connection is NEW ;<p>[…]<p>What has changed with the 3.18.x kernel : if neither nf_conntrack_pptp nor nf_conntrack_proto_gre are loaded, any GRE packet is INVALID.</blockquote><p>The solution, thus, both on Ubuntu and Fedora (and I expect others as well) is to always load the <code>nf_conntrack_pptp</code> module.<pre class=z-code><code><span class="z-text z-plain"># Fedora
</span><span class="z-text z-plain">echo nf_conntrack_pptp | sudo tee /etc/modules-load.d/pptp-firewall.conf
</span><span class="z-text z-plain">sudo modprobe nf_conntrack_pptp
</span><span class="z-text z-plain">
</span><span class="z-text z-plain"># Ubuntu and friends
</span><span class="z-text z-plain">echo nf_conntrack_pptp | sudo tee /etc/modules/pptp-firewall.conf
</span><span class="z-text z-plain">sudo modprobe nf_conntrack_pptp
</span></code></pre><p>Happy connecting!</section></article></main><div id=button-container><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://blog.wedrop.it/atom.xml> <img alt=feed loading=lazy src=https://blog.wedrop.it/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/teotwaki> <img alt=github loading=lazy src=https://blog.wedrop.it/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://mastodon.online/@teotwaki> <img alt=mastodon loading=lazy src=https://blog.wedrop.it/social_icons/mastodon.svg title=mastodon> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> <p><p>Drop a Blog © 2025 Sebastian Lauwers • Unless otherwise noted, the content in this website is available under the <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a> license.</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> • <a href=https://github.com/teotwaki/blog.wedrop.it> Site source </a></small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>